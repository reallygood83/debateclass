<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’¬ í•™ìƒ ì˜ê²¬ í”¼ë“œë°± ë„êµ¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #7c3aed;
            --primary-hover: #6d28d9;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --bg-color: #faf5ff;
            --card-bg: #ffffff;
            --text-color: #1f2937;
            --border-color: #e9d5ff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --gradient-primary: linear-gradient(135deg, var(--primary-color), #a855f7);
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            color: var(--text-color);
            min-height: 100vh;
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
        }

        .tab-navigation {
            display: flex;
            gap: 5px;
            margin-bottom: 30px;
            background: #f8fafc;
            border-radius: 12px;
            padding: 5px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #64748b;
        }

        .tab-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .student-input-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .textarea-field {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .submit-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(124, 58, 237, 0.3);
        }

        .opinion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .opinion-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .opinion-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.1);
            transform: translateY(-2px);
        }

        .opinion-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .student-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .student-name {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        .student-meta {
            font-size: 0.85rem;
            color: #6b7280;
        }

        .opinion-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        .status-reviewed {
            background: #dcfce7;
            color: #16a34a;
        }

        .status-needs-revision {
            background: #fee2e2;
            color: #dc2626;
        }

        .opinion-content {
            line-height: 1.6;
            color: var(--text-color);
            margin-bottom: 15px;
        }

        .opinion-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 15px;
        }

        .tag {
            background: #e0f2fe;
            color: #0369a1;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .feedback-section {
            border-top: 1px solid #e5e7eb;
            padding-top: 15px;
        }

        .feedback-content {
            background: #f8fafc;
            border-left: 4px solid var(--primary-color);
            padding: 12px 16px;
            margin-bottom: 15px;
            border-radius: 0 8px 8px 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .feedback-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .action-btn.primary {
            background: var(--primary-color);
            color: white;
        }

        .action-btn.primary:hover {
            background: var(--primary-hover);
        }

        .action-btn.success {
            background: var(--success-color);
            color: white;
        }

        .action-btn.success:hover {
            background: #059669;
        }

        .action-btn.warning {
            background: var(--warning-color);
            color: white;
        }

        .action-btn.warning:hover {
            background: #d97706;
        }

        .action-btn.secondary {
            background: #f3f4f6;
            color: var(--text-color);
        }

        .action-btn.secondary:hover {
            background: #e5e7eb;
        }

        .analytics-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 2px solid var(--border-color);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .stat-description {
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }

        .progress-bar {
            background: #f3f4f6;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 12px;
            background: var(--gradient-primary);
            border-radius: 8px;
            transition: width 0.5s ease;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }

        .empty-state .icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .floating-help {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--success-color);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .floating-help:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .export-section {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        .export-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            padding: 5px;
            border-radius: 4px;
        }

        .close-btn:hover {
            background: #f3f4f6;
            color: var(--text-color);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
                flex-direction: column;
                gap: 10px;
            }
            
            .opinion-grid {
                grid-template-columns: 1fr;
            }
            
            .analytics-section {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .card {
                padding: 20px;
            }

            .tab-navigation {
                flex-direction: column;
                gap: 5px;
            }

            .feedback-actions {
                flex-direction: column;
                gap: 8px;
            }

            .action-btn {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span>ğŸ’¬</span>
                í•™ìƒ ì˜ê²¬ í”¼ë“œë°± ë„êµ¬
            </h1>
            <p>í•™ìƒë“¤ì˜ ì˜ê²¬ì„ ì²´ê³„ì ìœ¼ë¡œ ìˆ˜ì§‘í•˜ê³  ê°œë³„ ë§ì¶¤ í”¼ë“œë°±ì„ ì œê³µí•˜ì„¸ìš”</p>
        </div>

        <div class="card">
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchTab('collect')">ì˜ê²¬ ìˆ˜ì§‘</button>
                <button class="tab-btn" onclick="switchTab('review')">ì˜ê²¬ ê²€í† </button>
                <button class="tab-btn" onclick="switchTab('analytics')">ë¶„ì„ ë¦¬í¬íŠ¸</button>
            </div>

            <!-- ì˜ê²¬ ìˆ˜ì§‘ íƒ­ -->
            <div class="tab-content active" id="collectTab">
                <div class="student-input-section">
                    <h3 style="margin-bottom: 20px; color: var(--primary-color);">ğŸ’­ ì˜ê²¬ ì‘ì„±í•˜ê¸°</h3>
                    <div class="input-group">
                        <label class="input-label">ì´ë¦„</label>
                        <input type="text" class="input-field" id="studentName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="input-group">
                        <label class="input-label">í•™ê¸‰/ëª¨ë‘ </label>
                        <input type="text" class="input-field" id="studentGroup" placeholder="ì˜ˆ: 5í•™ë…„ 1ë°˜ ë˜ëŠ” 1ëª¨ë‘ ">
                    </div>
                    <div class="input-group">
                        <label class="input-label">ì˜ê²¬ ì£¼ì œ</label>
                        <select class="input-field" id="opinionTopic">
                            <option value="">ì£¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="debate">í† ë¡  ì§„í–‰ì— ëŒ€í•œ ì˜ê²¬</option>
                            <option value="topic">í† ë¡  ì£¼ì œì— ëŒ€í•œ ì˜ê²¬</option>
                            <option value="process">í† ë¡  ê³¼ì •ì— ëŒ€í•œ í”¼ë“œë°±</option>
                            <option value="improvement">ê°œì„  ì œì•ˆì‚¬í•­</option>
                            <option value="learning">í•™ìŠµ ì†Œê°</option>
                            <option value="other">ê¸°íƒ€</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">ì˜ê²¬ ë‚´ìš©</label>
                        <textarea class="input-field textarea-field" id="opinionContent" 
                                  placeholder="ìì‹ ì˜ ìƒê°ê³¼ ì˜ê²¬ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”..."></textarea>
                    </div>
                    <div class="input-group">
                        <label class="input-label">ë§Œì¡±ë„ (ì„ íƒ)</label>
                        <select class="input-field" id="satisfaction">
                            <option value="">ë§Œì¡±ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="very-satisfied">ë§¤ìš° ë§Œì¡± ğŸ˜Š</option>
                            <option value="satisfied">ë§Œì¡± ğŸ™‚</option>
                            <option value="neutral">ë³´í†µ ğŸ˜</option>
                            <option value="dissatisfied">ë¶ˆë§Œì¡± ğŸ™</option>
                            <option value="very-dissatisfied">ë§¤ìš° ë¶ˆë§Œì¡± ğŸ˜</option>
                        </select>
                    </div>
                    <button class="submit-btn" onclick="submitOpinion()">
                        <span>ğŸ“</span>
                        ì˜ê²¬ ì œì¶œí•˜ê¸°
                    </button>
                </div>

                <div id="submitConfirmation" style="display: none; text-align: center; padding: 20px; background: #f0fff4; border-radius: 12px; border: 2px solid #10b981; color: #065f46;">
                    <h3>âœ… ì˜ê²¬ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!</h3>
                    <p>ì„ ìƒë‹˜ê»˜ì„œ ê²€í†  í›„ í”¼ë“œë°±ì„ ë“œë¦´ ì˜ˆì •ì…ë‹ˆë‹¤.</p>
                </div>
            </div>

            <!-- ì˜ê²¬ ê²€í†  íƒ­ -->
            <div class="tab-content" id="reviewTab">
                <div class="opinion-grid" id="opinionGrid">
                    <!-- ì˜ê²¬ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>

                <div class="empty-state" id="emptyOpinions">
                    <div class="icon">ğŸ’­</div>
                    <h3>ì•„ì§ ì œì¶œëœ ì˜ê²¬ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p>í•™ìƒë“¤ì´ ì˜ê²¬ì„ ì œì¶œí•˜ë©´ ì´ê³³ì— í‘œì‹œë©ë‹ˆë‹¤</p>
                </div>

                <div class="export-section" id="reviewExportSection" style="display: none;">
                    <button class="export-btn" onclick="exportFeedback('word')">
                        <span>ğŸ“„</span>
                        ì›Œë“œë¡œ ë‚´ë³´ë‚´ê¸°
                    </button>
                    <button class="export-btn" onclick="exportFeedback('excel')">
                        <span>ğŸ“Š</span>
                        ì—‘ì…€ë¡œ ë‚´ë³´ë‚´ê¸°
                    </button>
                    <button class="export-btn" onclick="printFeedback()">
                        <span>ğŸ–¨ï¸</span>
                        ì¸ì‡„í•˜ê¸°
                    </button>
                </div>
            </div>

            <!-- ë¶„ì„ ë¦¬í¬íŠ¸ íƒ­ -->
            <div class="tab-content" id="analyticsTab">
                <div class="analytics-section">
                    <div class="stat-card">
                        <div class="stat-number" id="totalOpinions">0</div>
                        <div class="stat-label">ì´ ì˜ê²¬ ìˆ˜</div>
                        <div class="stat-description">ì œì¶œëœ ì „ì²´ ì˜ê²¬</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="reviewedOpinions">0</div>
                        <div class="stat-label">ê²€í†  ì™„ë£Œ</div>
                        <div class="stat-description">í”¼ë“œë°± ì™„ë£Œ ì˜ê²¬</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="averageSatisfaction">0</div>
                        <div class="stat-label">í‰ê·  ë§Œì¡±ë„</div>
                        <div class="stat-description">5ì  ë§Œì  ê¸°ì¤€</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="responseRate">0%</div>
                        <div class="stat-label">ì‘ë‹µë¥ </div>
                        <div class="stat-description">ì „ì²´ í•™ìƒ ëŒ€ë¹„</div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">ğŸ“Š ì£¼ì œë³„ ì˜ê²¬ ë¶„í¬</div>
                    <div id="topicChart">
                        <div class="progress-label">
                            <span>í† ë¡  ì§„í–‰ì— ëŒ€í•œ ì˜ê²¬</span>
                            <span id="debatePercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="debateProgress" style="width: 0%;"></div>
                        </div>

                        <div class="progress-label">
                            <span>í† ë¡  ì£¼ì œì— ëŒ€í•œ ì˜ê²¬</span>
                            <span id="topicPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="topicProgress" style="width: 0%;"></div>
                        </div>

                        <div class="progress-label">
                            <span>í•™ìŠµ ì†Œê°</span>
                            <span id="learningPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="learningProgress" style="width: 0%;"></div>
                        </div>

                        <div class="progress-label">
                            <span>ê°œì„  ì œì•ˆì‚¬í•­</span>
                            <span id="improvementPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="improvementProgress" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">ğŸ˜Š ë§Œì¡±ë„ ë¶„ì„</div>
                    <div id="satisfactionChart">
                        <div class="progress-label">
                            <span>ë§¤ìš° ë§Œì¡±</span>
                            <span id="verySatisfiedPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="verySatisfiedProgress" style="width: 0%;"></div>
                        </div>

                        <div class="progress-label">
                            <span>ë§Œì¡±</span>
                            <span id="satisfiedPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="satisfiedProgress" style="width: 0%;"></div>
                        </div>

                        <div class="progress-label">
                            <span>ë³´í†µ</span>
                            <span id="neutralPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="neutralProgress" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- í”¼ë“œë°± ëª¨ë‹¬ -->
    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">âœï¸ í”¼ë“œë°± ì‘ì„±</div>
                <button class="close-btn" onclick="closeFeedbackModal()">&times;</button>
            </div>
            <div id="modalStudentInfo" style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;"></div>
            <div class="input-group">
                <label class="input-label">í”¼ë“œë°± ë‚´ìš©</label>
                <textarea class="input-field textarea-field" id="feedbackText" 
                          placeholder="í•™ìƒì˜ ì˜ê²¬ì— ëŒ€í•œ ê²©ë ¤ì™€ ê±´ì„¤ì ì¸ í”¼ë“œë°±ì„ ì‘ì„±í•´ì£¼ì„¸ìš”..."></textarea>
            </div>
            <div class="input-group">
                <label class="input-label">í”¼ë“œë°± ìœ í˜•</label>
                <select class="input-field" id="feedbackType">
                    <option value="positive">ê¸ì •ì  í”¼ë“œë°±</option>
                    <option value="constructive">ê±´ì„¤ì  ì œì•ˆ</option>
                    <option value="question">ì§ˆë¬¸/í™•ì¸</option>
                    <option value="clarification">ë³´ì¶© ì„¤ëª…</option>
                </select>
            </div>
            <div style="display: flex; gap: 10px; justify-content: end; margin-top: 20px;">
                <button class="action-btn secondary" onclick="closeFeedbackModal()">ì·¨ì†Œ</button>
                <button class="action-btn primary" onclick="saveFeedback()">í”¼ë“œë°± ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ë§¤ë‰´ì–¼ ë„ì›€ë§ ë²„íŠ¼ -->
    <button class="floating-help" onclick="showHelp()" title="ì‚¬ìš©ì ë§¤ë‰´ì–¼">ğŸ“‹</button>

    <script>
        let studentOpinions = [];
        let currentFeedbackOpinion = null;

        function switchTab(tabName) {
            // íƒ­ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // íƒ­ ë‚´ìš© í‘œì‹œ/ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.add('active');

            // ë¶„ì„ íƒ­ ì„ íƒ ì‹œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            if (tabName === 'analytics') {
                updateAnalytics();
            }
        }

        function submitOpinion() {
            const name = document.getElementById('studentName').value;
            const group = document.getElementById('studentGroup').value;
            const topic = document.getElementById('opinionTopic').value;
            const content = document.getElementById('opinionContent').value;
            const satisfaction = document.getElementById('satisfaction').value;

            // ì…ë ¥ ê²€ì¦
            if (!name || !content) {
                alert('ì´ë¦„ê³¼ ì˜ê²¬ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!topic) {
                alert('ì˜ê²¬ ì£¼ì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì˜ê²¬ ê°ì²´ ìƒì„±
            const opinion = {
                id: Date.now(),
                name: name,
                group: group || 'ë¯¸ì§€ì •',
                topic: topic,
                content: content,
                satisfaction: satisfaction,
                timestamp: new Date().toLocaleString('ko-KR'),
                status: 'pending',
                feedback: null
            };

            // ë°°ì—´ì— ì¶”ê°€
            studentOpinions.push(opinion);

            // í¼ ì´ˆê¸°í™”
            document.getElementById('studentName').value = '';
            document.getElementById('studentGroup').value = '';
            document.getElementById('opinionTopic').value = '';
            document.getElementById('opinionContent').value = '';
            document.getElementById('satisfaction').value = '';

            // í™•ì¸ ë©”ì‹œì§€ í‘œì‹œ
            document.getElementById('submitConfirmation').style.display = 'block';

            // 3ì´ˆ í›„ í™•ì¸ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
            setTimeout(() => {
                document.getElementById('submitConfirmation').style.display = 'none';
            }, 3000);

            // ì˜ê²¬ ê²€í†  íƒ­ ì—…ë°ì´íŠ¸
            updateOpinionGrid();

            console.log('ìƒˆ ì˜ê²¬ ì œì¶œ:', opinion);
        }

        function updateOpinionGrid() {
            const grid = document.getElementById('opinionGrid');
            const emptyState = document.getElementById('emptyOpinions');
            const exportSection = document.getElementById('reviewExportSection');

            if (studentOpinions.length === 0) {
                grid.style.display = 'none';
                emptyState.style.display = 'block';
                exportSection.style.display = 'none';
                return;
            }

            grid.style.display = 'grid';
            emptyState.style.display = 'none';
            exportSection.style.display = 'flex';

            const topicNames = {
                'debate': 'í† ë¡  ì§„í–‰ì— ëŒ€í•œ ì˜ê²¬',
                'topic': 'í† ë¡  ì£¼ì œì— ëŒ€í•œ ì˜ê²¬',
                'process': 'í† ë¡  ê³¼ì •ì— ëŒ€í•œ í”¼ë“œë°±',
                'improvement': 'ê°œì„  ì œì•ˆì‚¬í•­',
                'learning': 'í•™ìŠµ ì†Œê°',
                'other': 'ê¸°íƒ€'
            };

            const satisfactionEmojis = {
                'very-satisfied': 'ğŸ˜Š',
                'satisfied': 'ğŸ™‚',
                'neutral': 'ğŸ˜',
                'dissatisfied': 'ğŸ™',
                'very-dissatisfied': 'ğŸ˜'
            };

            grid.innerHTML = studentOpinions.map(opinion => `
                <div class="opinion-card">
                    <div class="opinion-header">
                        <div class="student-info">
                            <div class="student-name">${opinion.name}</div>
                            <div class="student-meta">${opinion.group} â€¢ ${opinion.timestamp}</div>
                        </div>
                        <div class="opinion-status status-${opinion.status}">
                            ${opinion.status === 'pending' ? 'ê²€í†  ëŒ€ê¸°' : 
                              opinion.status === 'reviewed' ? 'ê²€í†  ì™„ë£Œ' : 'ìˆ˜ì • í•„ìš”'}
                        </div>
                    </div>

                    <div class="opinion-tags">
                        <span class="tag">${topicNames[opinion.topic] || opinion.topic}</span>
                        ${opinion.satisfaction ? `<span class="tag">${satisfactionEmojis[opinion.satisfaction]} ë§Œì¡±ë„</span>` : ''}
                    </div>

                    <div class="opinion-content">${opinion.content}</div>

                    ${opinion.feedback ? `
                        <div class="feedback-section">
                            <div class="feedback-content">
                                <strong>ğŸ“ êµì‚¬ í”¼ë“œë°±:</strong><br>
                                ${opinion.feedback.content}
                            </div>
                        </div>
                    ` : ''}

                    <div class="feedback-actions">
                        <button class="action-btn primary" onclick="openFeedbackModal(${opinion.id})">
                            <span>âœï¸</span> ${opinion.feedback ? 'í”¼ë“œë°± ìˆ˜ì •' : 'í”¼ë“œë°± ì‘ì„±'}
                        </button>
                        <button class="action-btn success" onclick="markAsReviewed(${opinion.id})">
                            <span>âœ…</span> ê²€í†  ì™„ë£Œ
                        </button>
                        <button class="action-btn warning" onclick="markAsNeedsRevision(${opinion.id})">
                            <span>âš ï¸</span> ìˆ˜ì • í•„ìš”
                        </button>
                        <button class="action-btn secondary" onclick="deleteOpinion(${opinion.id})">
                            <span>ğŸ—‘ï¸</span> ì‚­ì œ
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function openFeedbackModal(opinionId) {
            const opinion = studentOpinions.find(op => op.id === opinionId);
            if (!opinion) return;

            currentFeedbackOpinion = opinion;

            const modal = document.getElementById('feedbackModal');
            const modalStudentInfo = document.getElementById('modalStudentInfo');
            const feedbackText = document.getElementById('feedbackText');
            const feedbackType = document.getElementById('feedbackType');

            // í•™ìƒ ì •ë³´ í‘œì‹œ
            modalStudentInfo.innerHTML = `
                <strong>${opinion.name}</strong> (${opinion.group})<br>
                <strong>ì£¼ì œ:</strong> ${opinion.topic}<br>
                <strong>ì˜ê²¬:</strong> ${opinion.content.length > 100 ? opinion.content.substring(0, 100) + '...' : opinion.content}
            `;

            // ê¸°ì¡´ í”¼ë“œë°±ì´ ìˆìœ¼ë©´ í‘œì‹œ
            if (opinion.feedback) {
                feedbackText.value = opinion.feedback.content;
                feedbackType.value = opinion.feedback.type;
            } else {
                feedbackText.value = '';
                feedbackType.value = 'positive';
            }

            modal.classList.add('active');
        }

        function closeFeedbackModal() {
            const modal = document.getElementById('feedbackModal');
            modal.classList.remove('active');
            currentFeedbackOpinion = null;
        }

        function saveFeedback() {
            if (!currentFeedbackOpinion) return;

            const feedbackContent = document.getElementById('feedbackText').value;
            const feedbackType = document.getElementById('feedbackType').value;

            if (!feedbackContent.trim()) {
                alert('í”¼ë“œë°± ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // í”¼ë“œë°± ì €ì¥
            currentFeedbackOpinion.feedback = {
                content: feedbackContent,
                type: feedbackType,
                timestamp: new Date().toLocaleString('ko-KR')
            };

            currentFeedbackOpinion.status = 'reviewed';

            // UI ì—…ë°ì´íŠ¸
            updateOpinionGrid();
            closeFeedbackModal();

            alert('í”¼ë“œë°±ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        function markAsReviewed(opinionId) {
            const opinion = studentOpinions.find(op => op.id === opinionId);
            if (opinion) {
                opinion.status = 'reviewed';
                updateOpinionGrid();
            }
        }

        function markAsNeedsRevision(opinionId) {
            const opinion = studentOpinions.find(op => op.id === opinionId);
            if (opinion) {
                opinion.status = 'needs-revision';
                updateOpinionGrid();
            }
        }

        function deleteOpinion(opinionId) {
            if (confirm('ì´ ì˜ê²¬ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                studentOpinions = studentOpinions.filter(op => op.id !== opinionId);
                updateOpinionGrid();
                updateAnalytics();
            }
        }

        function updateAnalytics() {
            const total = studentOpinions.length;
            const reviewed = studentOpinions.filter(op => op.status === 'reviewed').length;
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            document.getElementById('totalOpinions').textContent = total;
            document.getElementById('reviewedOpinions').textContent = reviewed;

            // ë§Œì¡±ë„ í‰ê·  ê³„ì‚°
            const satisfactionValues = {
                'very-satisfied': 5,
                'satisfied': 4,
                'neutral': 3,
                'dissatisfied': 2,
                'very-dissatisfied': 1
            };

            const satisfactionOpinions = studentOpinions.filter(op => op.satisfaction);
            const averageSatisfaction = satisfactionOpinions.length > 0 
                ? satisfactionOpinions.reduce((sum, op) => sum + satisfactionValues[op.satisfaction], 0) / satisfactionOpinions.length
                : 0;

            document.getElementById('averageSatisfaction').textContent = averageSatisfaction.toFixed(1);
            document.getElementById('responseRate').textContent = '100%'; // ì„ì‹œê°’

            // ì£¼ì œë³„ ë¶„í¬ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            if (total > 0) {
                const topicCounts = {
                    debate: studentOpinions.filter(op => op.topic === 'debate').length,
                    topic: studentOpinions.filter(op => op.topic === 'topic').length,
                    learning: studentOpinions.filter(op => op.topic === 'learning').length,
                    improvement: studentOpinions.filter(op => op.topic === 'improvement').length
                };

                updateProgressBar('debate', topicCounts.debate / total * 100);
                updateProgressBar('topic', topicCounts.topic / total * 100);
                updateProgressBar('learning', topicCounts.learning / total * 100);
                updateProgressBar('improvement', topicCounts.improvement / total * 100);

                // ë§Œì¡±ë„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
                const satisfactionCounts = {
                    verySatisfied: studentOpinions.filter(op => op.satisfaction === 'very-satisfied').length,
                    satisfied: studentOpinions.filter(op => op.satisfaction === 'satisfied').length,
                    neutral: studentOpinions.filter(op => op.satisfaction === 'neutral').length
                };

                updateProgressBar('verySatisfied', satisfactionCounts.verySatisfied / total * 100);
                updateProgressBar('satisfied', satisfactionCounts.satisfied / total * 100);
                updateProgressBar('neutral', satisfactionCounts.neutral / total * 100);
            }
        }

        function updateProgressBar(id, percentage) {
            document.getElementById(id + 'Progress').style.width = percentage + '%';
            document.getElementById(id + 'Percent').textContent = Math.round(percentage) + '%';
        }

        function exportFeedback(format) {
            if (studentOpinions.length === 0) {
                alert('ë‚´ë³´ë‚¼ ì˜ê²¬ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const content = generateExportContent();
            
            if (format === 'word') {
                const blob = new Blob([content], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `í•™ìƒ_ì˜ê²¬_í”¼ë“œë°±_${new Date().toISOString().split('T')[0]}.doc`;
                a.click();
                URL.revokeObjectURL(url);
            } else if (format === 'excel') {
                alert('ì—‘ì…€ ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ì´ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤. í˜„ì¬ëŠ” ì›Œë“œ í˜•ì‹ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
            }
        }

        function printFeedback() {
            if (studentOpinions.length === 0) {
                alert('ì¸ì‡„í•  ì˜ê²¬ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const content = generatePrintContent();
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                <head>
                    <title>í•™ìƒ ì˜ê²¬ í”¼ë“œë°±</title>
                    <style>
                        body { font-family: 'Malgun Gothic', sans-serif; line-height: 1.6; margin: 20px; }
                        h1 { color: #7c3aed; border-bottom: 2px solid #7c3aed; padding-bottom: 10px; }
                        .opinion-item { margin-bottom: 30px; page-break-inside: avoid; border: 1px solid #e5e7eb; padding: 15px; border-radius: 8px; }
                        .student-name { font-weight: bold; color: #7c3aed; font-size: 1.1rem; }
                        .opinion-meta { color: #666; font-size: 0.9rem; margin-bottom: 10px; }
                        .opinion-content { margin-bottom: 15px; background: #f8fafc; padding: 10px; border-radius: 4px; }
                        .feedback-content { background: #faf5ff; padding: 10px; border-left: 4px solid #7c3aed; border-radius: 0 4px 4px 0; }
                        @media print { 
                            body { margin: 0; } 
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    ${content}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function generateExportContent() {
            const topicNames = {
                'debate': 'í† ë¡  ì§„í–‰ì— ëŒ€í•œ ì˜ê²¬',
                'topic': 'í† ë¡  ì£¼ì œì— ëŒ€í•œ ì˜ê²¬',
                'process': 'í† ë¡  ê³¼ì •ì— ëŒ€í•œ í”¼ë“œë°±',
                'improvement': 'ê°œì„  ì œì•ˆì‚¬í•­',
                'learning': 'í•™ìŠµ ì†Œê°',
                'other': 'ê¸°íƒ€'
            };

            return `
                <html>
                <head>
                    <meta charset="utf-8">
                    <title>í•™ìƒ ì˜ê²¬ í”¼ë“œë°±</title>
                </head>
                <body>
                    <h1>ğŸ’¬ í•™ìƒ ì˜ê²¬ í”¼ë“œë°± ë¦¬í¬íŠ¸</h1>
                    <p><strong>ìƒì„± ì¼ì‹œ:</strong> ${new Date().toLocaleString('ko-KR')}</p>
                    <p><strong>ì´ ì˜ê²¬ ìˆ˜:</strong> ${studentOpinions.length}ê°œ</p>
                    <hr>
                    ${studentOpinions.map((opinion, index) => `
                        <h2>${index + 1}. ${opinion.name} (${opinion.group})</h2>
                        <p><strong>ì£¼ì œ:</strong> ${topicNames[opinion.topic] || opinion.topic}</p>
                        <p><strong>ì œì¶œ ì¼ì‹œ:</strong> ${opinion.timestamp}</p>
                        <p><strong>ì˜ê²¬ ë‚´ìš©:</strong></p>
                        <div style="background: #f8fafc; padding: 10px; border-radius: 4px; margin: 10px 0;">
                            ${opinion.content}
                        </div>
                        ${opinion.feedback ? `
                            <p><strong>êµì‚¬ í”¼ë“œë°±:</strong></p>
                            <div style="background: #faf5ff; padding: 10px; border-left: 4px solid #7c3aed; border-radius: 0 4px 4px 0; margin: 10px 0;">
                                ${opinion.feedback.content}
                            </div>
                        ` : ''}
                        <p><strong>ìƒíƒœ:</strong> ${opinion.status === 'reviewed' ? 'ê²€í†  ì™„ë£Œ' : opinion.status === 'pending' ? 'ê²€í†  ëŒ€ê¸°' : 'ìˆ˜ì • í•„ìš”'}</p>
                        <hr>
                    `).join('')}
                </body>
                </html>
            `;
        }

        function generatePrintContent() {
            const topicNames = {
                'debate': 'í† ë¡  ì§„í–‰ì— ëŒ€í•œ ì˜ê²¬',
                'topic': 'í† ë¡  ì£¼ì œì— ëŒ€í•œ ì˜ê²¬',
                'process': 'í† ë¡  ê³¼ì •ì— ëŒ€í•œ í”¼ë“œë°±',
                'improvement': 'ê°œì„  ì œì•ˆì‚¬í•­',
                'learning': 'í•™ìŠµ ì†Œê°',
                'other': 'ê¸°íƒ€'
            };

            return `
                <h1>ğŸ’¬ í•™ìƒ ì˜ê²¬ í”¼ë“œë°± ë¦¬í¬íŠ¸</h1>
                <div style="margin-bottom: 20px;">
                    <p><strong>ìƒì„± ì¼ì‹œ:</strong> ${new Date().toLocaleString('ko-KR')}</p>
                    <p><strong>ì´ ì˜ê²¬ ìˆ˜:</strong> ${studentOpinions.length}ê°œ</p>
                </div>
                ${studentOpinions.map((opinion, index) => `
                    <div class="opinion-item">
                        <div class="student-name">${index + 1}. ${opinion.name} (${opinion.group})</div>
                        <div class="opinion-meta">${topicNames[opinion.topic] || opinion.topic} | ${opinion.timestamp}</div>
                        <div class="opinion-content">
                            <strong>ì˜ê²¬:</strong> ${opinion.content}
                        </div>
                        ${opinion.feedback ? `
                            <div class="feedback-content">
                                <strong>êµì‚¬ í”¼ë“œë°±:</strong> ${opinion.feedback.content}
                            </div>
                        ` : ''}
                    </div>
                `).join('')}
            `;
        }

        function showHelp() {
            alert(`ğŸ’¬ í•™ìƒ ì˜ê²¬ í”¼ë“œë°± ë„êµ¬ ì‚¬ìš©ë²•

ğŸ¯ í•™ìƒ ì‚¬ìš©ë²•:
1. 'ì˜ê²¬ ìˆ˜ì§‘' íƒ­ì—ì„œ ì´ë¦„, í•™ê¸‰/ëª¨ë‘  ì…ë ¥
2. ì˜ê²¬ ì£¼ì œ ì„ íƒ (í† ë¡  ì§„í–‰, ì£¼ì œ, í•™ìŠµ ì†Œê° ë“±)
3. ì˜ê²¬ ë‚´ìš©ì„ ììœ ë¡­ê²Œ ì‘ì„±
4. ë§Œì¡±ë„ ì„ íƒ (ì„ íƒì‚¬í•­)
5. 'ì˜ê²¬ ì œì¶œí•˜ê¸°' ë²„íŠ¼ í´ë¦­

ğŸ‘¨â€ğŸ« êµì‚¬ ì‚¬ìš©ë²•:
1. 'ì˜ê²¬ ê²€í† ' íƒ­ì—ì„œ ì œì¶œëœ ì˜ê²¬ í™•ì¸
2. ê° ì˜ê²¬ì— ëŒ€í•´ ê°œë³„ í”¼ë“œë°± ì‘ì„±
3. 'ê²€í†  ì™„ë£Œ', 'ìˆ˜ì • í•„ìš”' ë“± ìƒíƒœ ì„¤ì •
4. 'ë¶„ì„ ë¦¬í¬íŠ¸' íƒ­ì—ì„œ ì „ì²´ í˜„í™© íŒŒì•…

ğŸ“Š ë¶„ì„ ê¸°ëŠ¥:
â€¢ ì´ ì˜ê²¬ ìˆ˜ ë° ê²€í†  í˜„í™©
â€¢ ì£¼ì œë³„ ì˜ê²¬ ë¶„í¬
â€¢ ë§Œì¡±ë„ ë¶„ì„
â€¢ ì‘ë‹µë¥  í†µê³„

ğŸ’¾ ë‚´ë³´ë‚´ê¸°:
â€¢ ì›Œë“œ ë¬¸ì„œë¡œ ì €ì¥
â€¢ ì¸ì‡„í•˜ì—¬ ì˜¤í”„ë¼ì¸ í™œìš©
â€¢ í•™ìƒë³„ ê°œë³„ í”¼ë“œë°± ê¸°ë¡ ìœ ì§€

ğŸ’¡ í™œìš© íŒ:
- í•™ìƒë“¤ì—ê²Œ êµ¬ì²´ì ì´ê³  ê±´ì„¤ì ì¸ í”¼ë“œë°± ì œê³µ
- ê¸ì •ì ì¸ ì¸¡ë©´ ë¨¼ì € ì–¸ê¸‰ í›„ ê°œì„ ì  ì œì‹œ
- ê°œë³„ í•™ìƒì˜ íŠ¹ì„±ê³¼ ìˆ˜ì¤€ì„ ê³ ë ¤í•œ ë§ì¶¤í˜• í”¼ë“œë°±`);
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('feedbackModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeFeedbackModal();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒ˜í”Œ ë°ì´í„° ì¶”ê°€ (í…ŒìŠ¤íŠ¸ìš©)
        window.addEventListener('load', function() {
            // ìƒ˜í”Œ ì˜ê²¬ ë°ì´í„° ì¶”ê°€ (ê°œë°œ/í…ŒìŠ¤íŠ¸ ëª©ì )
            const sampleOpinions = [
                {
                    id: 1,
                    name: 'ê¹€ë¯¼ìˆ˜',
                    group: '5í•™ë…„ 1ë°˜',
                    topic: 'debate',
                    content: 'í† ë¡ ì´ ì •ë§ ì¬ë¯¸ìˆì—ˆì–´ìš”! ì¹œêµ¬ë“¤ê³¼ ë‹¤ì–‘í•œ ì˜ê²¬ì„ ë‚˜ëˆŒ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ìŠµë‹ˆë‹¤. ë‹¤ìŒì—ë„ ì´ëŸ° í† ë¡  ì‹œê°„ì´ ìˆì—ˆìœ¼ë©´ ì¢‹ê² ì–´ìš”.',
                    satisfaction: 'very-satisfied',
                    timestamp: '2024-01-15 14:30:00',
                    status: 'pending',
                    feedback: null
                },
                {
                    id: 2,
                    name: 'ì´ì§€ì€',
                    group: '5í•™ë…„ 1ë°˜',
                    topic: 'improvement',
                    content: 'í† ë¡  ì‹œê°„ì´ ì¡°ê¸ˆ ë” ê¸¸ì—ˆìœ¼ë©´ ì¢‹ê² ì–´ìš”. ë§í•˜ê³  ì‹¶ì€ ê²ƒì´ ë§ì•˜ëŠ”ë° ì‹œê°„ì´ ë¶€ì¡±í•´ì„œ ì•„ì‰¬ì› ì–´ìš”.',
                    satisfaction: 'satisfied',
                    timestamp: '2024-01-15 14:35:00',
                    status: 'reviewed',
                    feedback: {
                        content: 'ì¢‹ì€ ì œì•ˆì´ì—ìš”! ë‹¤ìŒ í† ë¡ ì—ì„œëŠ” ì‹œê°„ì„ ì¡°ê¸ˆ ë” ëŠ˜ë ¤ì„œ ì§„í–‰í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì ê·¹ì ìœ¼ë¡œ ì°¸ì—¬í•´ì£¼ì…”ì„œ ê³ ë§ˆì›Œìš”.',
                        type: 'positive',
                        timestamp: '2024-01-15 16:00:00'
                    }
                }
            ];

            studentOpinions = sampleOpinions;
            updateOpinionGrid();
            updateAnalytics();
        });
    </script>
</body>
</html>